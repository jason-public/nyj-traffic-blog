<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë‚¨ì–‘ì£¼ì‹œ êµí†µêµ­ ì´ì•¼ê¸°</title>
  
  <!-- SheetJS ë¼ì´ë¸ŒëŸ¬ë¦¬ (Excel íŒŒì¼ ì½ê¸°ìš©) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  
  <style>
    :root {
      --color-white: rgba(255, 255, 255, 1);
      --color-black: rgba(0, 0, 0, 1);
      --color-cream-50: rgba(252, 252, 249, 1);
      --color-cream-100: rgba(255, 255, 253, 1);
      --color-gray-200: rgba(245, 245, 245, 1);
      --color-gray-300: rgba(167, 169, 169, 1);
      --color-gray-400: rgba(130, 130, 130, 1);
      --color-gray-500: rgba(109, 109, 109, 1);
      --color-gray-600: rgba(89, 89, 89, 1);
      --color-indigo-50: rgba(240, 245, 255, 1);
      --color-indigo-100: rgba(224, 236, 255, 1);
      --color-indigo-200: rgba(193, 215, 255, 1);
      --color-indigo-400: rgba(81, 155, 255, 1);
      --color-indigo-500: rgba(49, 130, 255, 1);
      --color-indigo-600: rgba(37, 106, 219, 1);
      --color-indigo-700: rgba(31, 84, 178, 1);
      --color-indigo-800: rgba(29, 69, 144, 1);
      --color-indigo-900: rgba(24, 50, 111, 1);
      --color-orange-400: rgba(255, 164, 62, 1);
      --color-orange-500: rgba(255, 140, 20, 1);
      --color-orange-600: rgba(227, 113, 17, 1);
      --color-red-500: rgba(255, 83, 83, 1);
      --color-red-600: rgba(227, 73, 73, 1);
      --color-green-500: rgba(63, 171, 103, 1);
      --color-green-600: rgba(48, 143, 79, 1);
      --color-yellow-200: rgba(255, 234, 150, 1);
      --color-yellow-400: rgba(254, 197, 20, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background-color: var(--color-cream-50);
      color: var(--color-gray-600);
      line-height: 1.6;
    }

    header {
      background: linear-gradient(135deg, var(--color-indigo-600) 0%, var(--color-indigo-800) 100%);
      color: white;
      padding: 2rem 0;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    header h1 {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    header p {
      font-size: 0.95rem;
      opacity: 0.9;
    }

    @media (max-width: 768px) {
      header h1 {
        font-size: 1.5rem;
      }

      header p {
        font-size: 0.85rem;
      }
    }

    @media (max-width: 480px) {
      header {
        padding: 1.5rem 0;
      }

      header h1 {
        font-size: 1.2rem;
      }

      header p {
        font-size: 0.8rem;
      }
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1.5rem;
    }

    nav {
      background-color: white;
      border-bottom: 1px solid var(--color-gray-200);
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    .nav-tabs {
      display: flex;
      gap: 0;
      list-style: none;
      overflow-x: auto;
    }

    .nav-tabs li {
      flex: 1;
      min-width: 120px;
    }

    @media (max-width: 768px) {
      .nav-tabs li {
        min-width: 100px;
      }

      .nav-tabs button {
        padding: 0.8rem;
        font-size: 0.85rem;
      }
    }

    @media (max-width: 480px) {
      .nav-tabs li {
        min-width: 80px;
      }

      .nav-tabs button {
        padding: 0.6rem;
        font-size: 0.75rem;
      }
    }

    .nav-tabs button {
      width: 100%;
      padding: 1rem;
      border: none;
      background: none;
      color: var(--color-gray-500);
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 3px solid transparent;
    }

    .nav-tabs button:hover {
      color: var(--color-indigo-600);
      background-color: var(--color-cream-50);
    }

    .nav-tabs button.active {
      color: var(--color-indigo-600);
      border-bottom-color: var(--color-indigo-600);
    }

    .admin-btn {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background-color: var(--color-indigo-600);
      color: white;
      border: none;
      cursor: pointer;
      font-size: 1.5rem;
      box-shadow: 0 4px 12px rgba(37, 106, 219, 0.3);
      transition: all 0.3s ease;
      z-index: 999;
    }

    .admin-btn:hover {
      background-color: var(--color-indigo-700);
      box-shadow: 0 6px 16px rgba(37, 106, 219, 0.4);
      transform: scale(1.1);
    }

    main {
      display: grid;
      grid-template-columns: 1fr 280px;
      gap: 2rem;
      padding: 2rem 0;
    }

    @media (max-width: 1024px) {
      main {
        grid-template-columns: 1fr;
      }

      aside {
        display: none;
      }
    }

    .blog-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    @media (max-width: 768px) {
      .blog-grid {
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 1rem;
      }
    }

    @media (max-width: 480px) {
      .blog-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
      }
    }

    .blog-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      transition: all 0.3s ease;
      cursor: pointer;
      border: 1px solid var(--color-gray-200);
    }

    .blog-card:hover {
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
      transform: translateY(-4px);
      border-color: var(--color-indigo-200);
    }

    .blog-card-image {
      width: 100%;
      height: 180px;
      background: linear-gradient(135deg, var(--color-indigo-100) 0%, var(--color-indigo-50) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--color-indigo-400);
      font-size: 2.5rem;
      overflow: hidden;
    }

    .blog-card-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .blog-card-content {
      padding: 1.5rem;
    }

    .blog-card-category {
      display: inline-block;
      font-size: 0.75rem;
      font-weight: 600;
      padding: 0.4rem 0.8rem;
      border-radius: 20px;
      margin-bottom: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .blog-card-category.category-truck {
      background-color: var(--color-orange-400);
      color: white;
    }

    .blog-card-category.category-news {
      background-color: var(--color-indigo-500);
      color: white;
    }

    .blog-card-category.category-etc {
      background-color: var(--color-green-500);
      color: white;
    }

    .blog-card-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--color-gray-600);
      margin-bottom: 0.8rem;
      line-height: 1.4;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    @media (max-width: 480px) {
      .blog-card-title {
        font-size: 0.95rem;
        margin-bottom: 0.6rem;
      }
    }

    .blog-card-summary {
      font-size: 0.9rem;
      color: var(--color-gray-400);
      margin-bottom: 1rem;
      line-height: 1.5;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .blog-card-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 1rem;
      border-top: 1px solid var(--color-gray-200);
      font-size: 0.85rem;
      color: var(--color-gray-300);
    }

    .blog-card-date {
      font-weight: 500;
    }

    .blog-card-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .blog-card-tag {
      font-size: 0.75rem;
      background-color: var(--color-indigo-50);
      color: var(--color-indigo-600);
      padding: 0.3rem 0.6rem;
      border-radius: 4px;
      white-space: nowrap;
    }

    aside {
      display: flex;
      flex-direction: column;
      gap: 2rem;
    }

    .sidebar-widget {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
      border: 1px solid var(--color-gray-200);
    }

    .sidebar-widget h3 {
      font-size: 1rem;
      font-weight: 600;
      color: var(--color-gray-600);
      margin-bottom: 1rem;
      padding-bottom: 0.8rem;
      border-bottom: 2px solid var(--color-indigo-500);
    }

    .sidebar-item {
      padding: 0.8rem 0;
      font-size: 0.9rem;
      color: var(--color-gray-500);
      border-bottom: 1px solid var(--color-gray-200);
    }

    .sidebar-item:last-child {
      border-bottom: none;
    }

    .sidebar-item-link {
      color: var(--color-indigo-600);
      text-decoration: none;
      cursor: pointer;
      font-weight: 500;
    }

    .sidebar-item-link:hover {
      text-decoration: underline;
    }

    .sidebar-item-count {
      float: right;
      background-color: var(--color-indigo-100);
      color: var(--color-indigo-600);
      padding: 0.2rem 0.6rem;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: 600;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      animation: fadeIn 0.3s ease;
    }

    .modal.show {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }


    .modal-content {
      background-color: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      max-width: 600px;
      width: 90%;
      max-height: 90vh;
      animation: slideIn 0.3s ease;
      overflow-y: auto;
    }

    @media (max-width: 768px) {
      .modal-content {
        padding: 1.5rem;
        max-height: 95vh;
        width: 95%;
      }
    }

    @media (max-width: 480px) {
      .modal-content {
        padding: 1rem;
        max-height: 95vh;
        width: 98%;
        max-width: 100%;
      }
    }

    @keyframes slideIn {
      from {
        transform: translateY(-50px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .modal-header {
      font-size: 1.3rem;
      font-weight: 600;
      color: var(--color-gray-600);
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid var(--color-indigo-500);
    }

    .modal-body {
      margin-bottom: 2rem;
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: var(--color-gray-600);
      font-size: 0.95rem;
    }

    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 0.8rem;
      border: 1px solid var(--color-gray-200);
      border-radius: 6px;
      font-family: inherit;
      font-size: 0.9rem;
      transition: border-color 0.3s ease;
    }

    .form-group input:focus,
    .form-group textarea:focus,
    .form-group select:focus {
      outline: none;
      border-color: var(--color-indigo-500);
      box-shadow: 0 0 0 3px var(--color-indigo-100);
    }

    .form-group textarea {
      resize: vertical;
      min-height: 120px;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
    }

    .modal-footer {
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
    }

    .btn {
      padding: 0.8rem 1.5rem;
      border: none;
      border-radius: 6px;
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background-color: var(--color-indigo-600);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--color-indigo-700);
    }

    .btn-secondary {
      background-color: var(--color-gray-200);
      color: var(--color-gray-600);
    }

    .btn-secondary:hover {
      background-color: var(--color-gray-300);
    }

    .btn-danger {
      background-color: var(--color-red-500);
      color: white;
    }

    .btn-danger:hover {
      background-color: var(--color-red-600);
    }

    .btn-small {
      padding: 0.5rem 1rem;
      font-size: 0.85rem;
    }

    .file-input-label {
      display: inline-block;
      padding: 0.8rem 1.5rem;
      background-color: var(--color-indigo-100);
      color: var(--color-indigo-600);
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .file-input-label:hover {
      background-color: var(--color-indigo-200);
    }

    .file-input-label input[type="file"] {
      display: none;
    }

    .file-name {
      margin-top: 0.5rem;
      font-size: 0.85rem;
      color: var(--color-gray-400);
    }

    .toast {
      position: fixed;
      bottom: 2rem;
      right: 2rem;
      background-color: var(--color-indigo-600);
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      animation: slideUp 0.3s ease;
      z-index: 2000;
    }

    @keyframes slideUp {
      from {
        transform: translateY(20px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .toast.error {
      background-color: var(--color-red-500);
    }

    .toast.success {
      background-color: var(--color-green-500);
    }

    .empty-state {
      text-align: center;
      padding: 3rem 2rem;
      color: var(--color-gray-400);
    }

    .empty-state-icon {
      font-size: 3rem;
      margin-bottom: 1rem;
    }

    .empty-state-text {
      font-size: 1.1rem;
      color: var(--color-gray-500);
    }

    .modal-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--color-gray-600);
      margin-bottom: 1rem;
    }

    .modal-message {
      color: var(--color-gray-500);
      margin-bottom: 2rem;
      line-height: 1.6;
    }

    .detail-image {
      width: 100%;
      max-height: 300px;
      margin-bottom: 1rem;
      border-radius: 8px;
      object-fit: cover;
    }

    .detail-image-placeholder {
      height: 200px;
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>ğŸšš ë‚¨ì–‘ì£¼ì‹œ êµí†µêµ­ ì´ì•¼ê¸°</h1>
      <p>êµí†µêµ­ ì£¼ìš” ì†Œì‹ì„ ì•Œë ¤ì£¼ëŠ” ì •ë³´ ê³µìœ  ë¸”ë¡œê·¸</p>
    </div>
  </header>

  <nav>
    <div class="container">
      <ul class="nav-tabs">
        <li><button class="nav-tab active" data-category="all">ì „ì²´</button></li>
        <li><button class="nav-tab" data-category="êµí†µêµ­ ì´ì•¼ê¸°">êµí†µêµ­ ì´ì•¼ê¸°</button></li>
        <li><button class="nav-tab" data-category="ì£¼ìš” ì†Œì‹">ì£¼ìš” ì†Œì‹</button></li>
        <li><button class="nav-tab" data-category="ê¸°íƒ€">ê¸°íƒ€</button></li>
      </ul>
    </div>
  </nav>

  <main class="container">
    <div class="blog-grid" id="blogGrid"></div>
    <aside id="sidebar"></aside>
  </main>

  <!-- ê´€ë¦¬ì ì¸ì¦ ëª¨ë‹¬ -->
  <div id="passwordModal" class="modal">
    <div class="modal-content" style="max-width: 400px;">
      <div class="modal-header">ğŸ” ê´€ë¦¬ì ì¸ì¦</div>
      <div class="modal-body">
        <div class="form-group">
          <label>ê´€ë¦¬ì ì•”í˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”</label>
          <input type="password" id="passwordInput" placeholder="ì•”í˜¸">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closePasswordModalFunc()">ì·¨ì†Œ</button>
        <button class="btn btn-primary" onclick="validatePassword()">í™•ì¸</button>
      </div>
      <p id="passwordError" style="color: var(--color-red-500); font-size: 0.85rem; margin-top: 1rem; display: none;">
        ì•”í˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.
      </p>
    </div>
  </div>

  <!-- ìƒˆ ê¸€ ì‘ì„± ëª¨ë‹¬ -->
  <div id="newPostModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">âœï¸ ìƒˆ ê¸€ ì‘ì„±</div>
      <div class="modal-body">
        <div class="form-group">
          <label>ì œëª©</label>
          <input type="text" id="newPostTitle" placeholder="ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”">
        </div>
        <div class="form-group">
          <label>ë‚´ìš©</label>
          <textarea id="newPostContent" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”"></textarea>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>ì¹´í…Œê³ ë¦¬</label>
            <select id="newPostCategory">
              <option value="êµí†µêµ­ ì´ì•¼ê¸°">êµí†µêµ­ ì´ì•¼ê¸°</option>
              <option value="ì£¼ìš” ì†Œì‹">ì£¼ìš” ì†Œì‹</option>
              <option value="ê¸°íƒ€">ê¸°íƒ€</option>
            </select>
          </div>
          <div class="form-group">
            <label>íƒœê·¸</label>
            <input type="text" id="newPostTags" placeholder="ì‰¼í‘œë¡œ êµ¬ë¶„">
          </div>
        </div>
        <div class="form-group">
          <label>ì´ë¯¸ì§€ (ì„ íƒ)</label>
          <label class="file-input-label">
            ğŸ“· ì´ë¯¸ì§€ ì„ íƒ
            <input type="file" accept="image/*" onchange="handleImageUpload(event)">
          </label>
          <div class="file-name" id="imageName"></div>
        </div>
        <div class="form-group">
          <label>íŒŒì¼ ì²¨ë¶€ (ì„ íƒ)</label>
          <label class="file-input-label">
            ğŸ“ íŒŒì¼ ì„ íƒ
            <input type="file" onchange="handleFileUpload(event)">
          </label>
          <div class="file-name" id="fileName"></div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeNewPostModalFunc()">ì·¨ì†Œ</button>
        <button class="btn btn-primary" onclick="submitNewPostFunc()">ê²Œì‹œ</button>
      </div>
    </div>
  </div>

  <!-- ìƒì„¸ ë³´ê¸° ëª¨ë‹¬ -->
  <div id="detailModal" class="modal">
    <div class="modal-content">
      <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 2rem;">
        <div>
          <div id="detailCategory" class="blog-card-category"></div>
          <h2 id="detailTitle" style="font-size: 1.5rem; color: var(--color-gray-600); margin-top: 0.5rem;"></h2>
        </div>
        <button onclick="closeDetailModal()" style="border: none; background: none; font-size: 1.5rem; cursor: pointer; color: var(--color-gray-300);">âœ•</button>
      </div>
      <div id="detailImageContainer" style="margin-bottom: 2rem;">
        <img id="detailImage" style="width: 100%; max-height: 400px; height: auto; border-radius: 8px; cursor: pointer; display: none; object-fit: cover;" alt="ê²Œì‹œê¸€ ì´ë¯¸ì§€" onclick="openImageViewer(this)">
      </div>
      <div id="detailContent" style="color: var(--color-gray-500); line-height: 1.8; margin-bottom: 2rem;"></div>
      <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 1.5rem; border-top: 1px solid var(--color-gray-200);">
        <div id="detailDate" style="font-size: 0.9rem; color: var(--color-gray-400);"></div>
      </div>
    </div>
  </div>

  <!-- ì´ë¯¸ì§€ ë·°ì–´ ëª¨ë‹¬ -->
  <div id="imageViewerModal" class="modal">
    <div style="position: relative; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
      <button onclick="closeImageViewer()" style="position: fixed; top: 20px; right: 20px; background-color: rgba(255, 255, 255, 0.9); border: none; width: 40px; height: 40px; border-radius: 50%; font-size: 24px; cursor: pointer; z-index: 1001; display: flex; align-items: center; justify-content: center;">âœ•</button>
      <img id="imageViewerImg" style="max-width: 90%; max-height: 90%; object-fit: contain;" alt="í™•ëŒ€ ì´ë¯¸ì§€">
    </div>
  </div>

  <!-- ì‚­ì œ í™•ì¸ ëª¨ë‹¬ -->
  <div id="deleteModal" class="modal">
    <div class="modal-content" style="max-width: 400px;">
      <div class="modal-header">âš ï¸ ê¸€ ì‚­ì œ</div>
      <div class="modal-body">
        <p class="modal-message">ì •ë§ë¡œ ì´ ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
        <div class="form-group">
          <label>ê´€ë¦¬ì ì•”í˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”</label>
          <input type="password" id="deletePasswordInput" placeholder="ì•”í˜¸">
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" onclick="closeDeleteModalFunc()">ì·¨ì†Œ</button>
        <button class="btn btn-danger" onclick="validateDeletePassword()">ì‚­ì œ</button>
      </div>
      <p id="deletePasswordError" style="color: var(--color-red-500); font-size: 0.85rem; margin-top: 1rem; display: none;">
        ì•”í˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
      </p>
    </div>
  </div>

  <!-- ê´€ë¦¬ì ë²„íŠ¼ -->
  <button class="admin-btn" onclick="openPasswordModal()">ğŸ‘¨â€ğŸ’¼</button>

  <script>
    // =====================================================
    // ì „ì—­ ë³€ìˆ˜
    // =====================================================
    let posts = [];
    let nextId = 1;
    let selectedImageData = null;
    let selectedFileData = null;
    let selectedFileName = '';
    let currentCategory = 'all';
    let postToDelete = null;

    // =====================================================
    // Excel íŒŒì¼ì—ì„œ ê²Œì‹œê¸€ ë¡œë“œ í•¨ìˆ˜
    // =====================================================
    function loadPostsFromExcel() {
      fetch('posts.xlsx')
        .then(res => {
          if (!res.ok) {
            console.warn('âš ï¸ Excel íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ë³¸ ë°ì´í„°ë¡œ ì‹œì‘í•©ë‹ˆë‹¤.');
            renderBlogGrid();
            renderSidebar();
            return;
          }
          return res.arrayBuffer();
        })
        .then(arrayBuffer => {
          if (!arrayBuffer) return;
          
          try {
            const workbook = XLSX.read(arrayBuffer, { type: 'array' });
            const sheetName = workbook.SheetNames[0];
            const sheet = workbook.Sheets[sheetName];
            const jsonData = XLSX.utils.sheet_to_json(sheet);
            
            // Excel ë°ì´í„°ë¥¼ posts ë°°ì—´ë¡œ ë³€í™˜
            posts = jsonData.map((row, index) => {
              return {
                id: row.id || (index + 1),
                title: row.title || row['ì œëª©'] || '',
                content: row.content || row['ë‚´ìš©'] || '',
                category: row.category || row['ì¹´í…Œê³ ë¦¬'] || 'ê¸°íƒ€',
                date: row.date || row['ë‚ ì§œ'] || new Date().toISOString().split('T')[0],
                tags: row.tags ? (typeof row.tags === 'string' ? row.tags.split(',').map(t => t.trim()) : []) : [],
                imageUrl: row.imageUrl || row['ì´ë¯¸ì§€'] || null,
                file: row.file || row['íŒŒì¼'] || null
              };
            });
            
            // nextId ì—…ë°ì´íŠ¸
            if (posts.length > 0) {
              nextId = Math.max(...posts.map(p => p.id)) + 1;
            }
            
            console.log(`âœ“ ${posts.length}ê°œì˜ ê²Œì‹œê¸€ì„ Excelì—ì„œ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`);
            
            // í™”ë©´ ë Œë”ë§
            renderBlogGrid();
            renderSidebar();
            
            // í† ìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ
            if (posts.length > 0) {
              showToast(`${posts.length}ê°œì˜ ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤.`, 'success');
            }
          } catch (err) {
            console.error('Excel íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜:', err);
            renderBlogGrid();
            renderSidebar();
          }
        })
        .catch(err => {
          console.warn('Excel íŒŒì¼ ë¡œë“œ ì‹¤íŒ¨:', err);
          renderBlogGrid();
          renderSidebar();
        });
    }

    // =====================================================
    // ë Œë”ë§ í•¨ìˆ˜
    // =====================================================
    function formatDate(dateString) {
      const date = new Date(dateString);
      const year = date.getFullYear();
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const day = String(date.getDate()).padStart(2, '0');
      return `${year}ë…„ ${month}ì›” ${day}ì¼`;
    }

    function getCategoryClass(category) {
      switch (category) {
        case 'êµí†µêµ­ ì´ì•¼ê¸°':
          return 'category-truck';
        case 'ì£¼ìš” ì†Œì‹':
          return 'category-news';
        case 'ê¸°íƒ€':
          return 'category-etc';
        default:
          return 'category-etc';
      }
    }

    function filterPosts() {
      if (currentCategory === 'all') {
        return posts;
      }
      return posts.filter(post => post.category === currentCategory);
    }

    function renderBlogCard(post) {
      return `
        <div class="blog-card" onclick="showPostDetail(${post.id})">
          <div class="blog-card-image">
            ${post.imageUrl ? `<img src="${post.imageUrl}" alt="${post.title}">` : 'ğŸ“°'}
          </div>
          <div class="blog-card-content">
            <span class="blog-card-category ${getCategoryClass(post.category)}">${post.category}</span>
            <h3 class="blog-card-title">${post.title}</h3>
            <p class="blog-card-summary">${post.content.substring(0, 100)}...</p>
            <div class="blog-card-footer">
              <span class="blog-card-date">${formatDate(post.date)}</span>
              <div class="blog-card-tags">
                ${post.tags.slice(0, 2).map(tag => `<span class="blog-card-tag">${tag}</span>`).join('')}
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function renderBlogGrid() {
      const blogGrid = document.getElementById('blogGrid');
      const filtered = filterPosts();

      if (filtered.length === 0) {
        blogGrid.innerHTML = `
          <div style="grid-column: 1 / -1;">
            <div class="empty-state">
              <div class="empty-state-icon">ğŸ“­</div>
              <div class="empty-state-text">ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</div>
            </div>
          </div>
        `;
        return;
      }

      blogGrid.innerHTML = filtered.map(post => renderBlogCard(post)).join('');
    }

    function renderSidebar() {
      const sidebar = document.getElementById('sidebar');

      // ìµœê·¼ ê¸€
      const recentPosts = posts.sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 5);
      const recentHtml = `
        <div class="sidebar-widget">
          <h3>ğŸ“… ìµœê·¼ ê¸€</h3>
          ${recentPosts.map(post => `
            <div class="sidebar-item">
              <a class="sidebar-item-link" onclick="showPostDetail(${post.id})">${post.title}</a>
            </div>
          `).join('')}
        </div>
      `;

      // ì¹´í…Œê³ ë¦¬
      const categories = [...new Set(posts.map(p => p.category))];
      const categoryHtml = `
        <div class="sidebar-widget">
          <h3>ğŸ“‚ ì¹´í…Œê³ ë¦¬</h3>
          ${categories.map(cat => {
            const count = posts.filter(p => p.category === cat).length;
            return `
              <div class="sidebar-item">
                <a class="sidebar-item-link" onclick="currentCategory = '${cat}'; updateActiveTab('${cat}'); renderBlogGrid();">${cat}</a>
                <span class="sidebar-item-count">${count}</span>
              </div>
            `;
          }).join('')}
        </div>
      `;

      sidebar.innerHTML = recentHtml + categoryHtml;
    }

    function showPostDetail(id) {
      const post = posts.find(p => p.id === id);
      if (!post) return;

      postToDelete = id;
      document.getElementById('detailTitle').textContent = post.title;
      document.getElementById('detailCategory').textContent = post.category;
      document.getElementById('detailCategory').className = `blog-card-category ${getCategoryClass(post.category)}`;

      // ì´ë¯¸ì§€ í‘œì‹œ
      const detailImage = document.getElementById('detailImage');
      if (post.imageUrl) {
        detailImage.src = post.imageUrl;
        detailImage.style.display = 'block';
      } else {
        detailImage.style.display = 'none';
      }

      document.getElementById('detailContent').textContent = post.content;
      document.getElementById('detailDate').textContent = formatDate(post.date);

      const detailModal = document.getElementById('detailModal');
      detailModal.classList.add('show');
    }

    function closeDetailModal() {
      document.getElementById('detailModal').classList.remove('show');
      postToDelete = null;
    }

    function updateActiveTab(category) {
      document.querySelectorAll('.nav-tab').forEach(tab => {
        tab.classList.remove('active');
        if (tab.dataset.category === category) {
          tab.classList.add('active');
        }
      });
    }

    // =====================================================
    // ëª¨ë‹¬ í•¨ìˆ˜
    // =====================================================
    function openPasswordModal() {
      document.getElementById('passwordModal').classList.add('show');
      document.getElementById('passwordInput').value = '';
      document.getElementById('passwordError').style.display = 'none';
    }

    function closePasswordModalFunc() {
      document.getElementById('passwordModal').classList.remove('show');
    }

    function validatePassword() {
      const password = document.getElementById('passwordInput').value;
      if (password === 'admin123') {
        closePasswordModalFunc();
        openNewPostModal();
      } else {
        document.getElementById('passwordError').style.display = 'block';
      }
    }

    function openDeleteModal() {
      document.getElementById('deleteModal').classList.add('show');
      document.getElementById('deletePasswordInput').value = '';
      document.getElementById('deletePasswordError').style.display = 'none';
    }

    function closeDeleteModalFunc() {
      document.getElementById('deleteModal').classList.remove('show');
    }

    function validateDeletePassword() {
      const password = document.getElementById('deletePasswordInput').value;
      if (password === 'admin123') {
        deletePost();
        closeDeleteModalFunc();
        closeDetailModal();
      } else {
        document.getElementById('deletePasswordError').style.display = 'block';
      }
    }

    function deletePost() {
      posts = posts.filter(p => p.id !== postToDelete);
      renderBlogGrid();
      renderSidebar();
      showToast('ê²Œì‹œê¸€ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
    }

        function openImageViewer(imgElement) {
      const viewerImg = document.getElementById('imageViewerImg');
      viewerImg.src = imgElement.src;

      const modal = document.getElementById('imageViewerModal');
      modal.classList.add('show');
    }

    function closeImageViewer() {
      document.getElementById('imageViewerModal').classList.remove('show');
    }

    function showToast(message, type = 'info') {
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      document.body.appendChild(toast);

      setTimeout(() => {
        toast.style.animation = 'slideDown 0.3s ease forwards';
        setTimeout(() => toast.remove(), 300);
      }, 2000);
    }

    function openNewPostModal() {
      document.getElementById('newPostModal').classList.add('show');
      document.getElementById('newPostTitle').value = '';
      document.getElementById('newPostContent').value = '';
      document.getElementById('newPostTags').value = '';
      document.getElementById('imageName').textContent = '';
      document.getElementById('fileName').textContent = '';
      selectedImageData = null;
      selectedFileData = null;
      selectedFileName = '';
    }

    function closeNewPostModalFunc() {
      document.getElementById('newPostModal').classList.remove('show');
    }

    function handleImageUpload(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => {
          selectedImageData = e.target.result;
          document.getElementById('imageName').textContent = `ì„ íƒë¨: ${file.name}`;
        };
        reader.readAsDataURL(file);
      }
    }

    function handleFileUpload(event) {
      const file = event.target.files[0];
      if (file) {
        selectedFileData = file;
        selectedFileName = file.name;
        document.getElementById('fileName').textContent = `ì„ íƒë¨: ${file.name}`;
      }
    }

    function submitNewPostFunc() {
      const title = document.getElementById('newPostTitle').value.trim();
      const content = document.getElementById('newPostContent').value.trim();
      const category = document.getElementById('newPostCategory').value;
      const tagsInput = document.getElementById('newPostTags').value.trim();

      if (!title || !content) {
        showToast('ì œëª©ê³¼ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.', 'error');
        return;
      }

      const tags = tagsInput ? tagsInput.split(',').map(t => t.trim()) : [];
      const newPost = {
        id: nextId++,
        title,
        content,
        category,
        date: new Date().toISOString().split('T')[0],
        tags,
        imageUrl: selectedImageData,
        file: selectedFileName
      };

      posts.push(newPost);
      closeNewPostModalFunc();
      renderBlogGrid();
      renderSidebar();
      showToast('ê²Œì‹œê¸€ì´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
    }

    // =====================================================
    // í˜ì´ì§€ ë¡œë“œ ì‹œ Excel íŒŒì¼ì—ì„œ ë°ì´í„° ìë™ ë¡œë“œ
    // =====================================================
    window.addEventListener('DOMContentLoaded', () => {
      loadPostsFromExcel();
    });

    // DOM ìš”ì†Œ
    const navTabs = document.querySelectorAll('.nav-tab');
    const searchInput = document.getElementById('searchInput');

    // ë„¤ë¹„ê²Œì´ì…˜ íƒ­ ì´ë²¤íŠ¸
    navTabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const category = tab.dataset.category;
        currentCategory = category;
        updateActiveTab(category);
        renderBlogGrid();
      });
    });

    // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
    window.addEventListener('click', (event) => {
      const passwordModal = document.getElementById('passwordModal');
      const newPostModal = document.getElementById('newPostModal');
      const detailModal = document.getElementById('detailModal');
      const deleteModal = document.getElementById('deleteModal');

      if (event.target === passwordModal) closePasswordModalFunc();
      if (event.target === newPostModal) closeNewPostModalFunc();
      if (event.target === detailModal) closeDetailModal();
      if (event.target === deleteModal) closeDeleteModalFunc();
      if (event.target === imageViewerModal) closeImageViewer();
    });

    // Enter í‚¤ë¡œ ì•”í˜¸ ê²€ì¦
    document.getElementById('passwordInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') validatePassword();
    });

    document.getElementById('deletePasswordInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') validateDeletePassword();
    });
  </script>
</body>
</html>